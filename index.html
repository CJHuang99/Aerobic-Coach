<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>James æœ‰æ°§è¨“ç·´å°ˆå±¬æ•™ç·´</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      background-color: #f8fafc;
      /* Slate-50 */
      -webkit-tap-highlight-color: transparent;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-thumb {
      background-color: #cbd5e1;
      border-radius: 3px;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // --- Icon Components ---
    const IconBase = ({ d, className, color = "currentColor" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        {d}
      </svg>
    );

    const Heart = (p) => <IconBase {...p} d={<path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />} />;
    const Activity = (p) => <IconBase {...p} d={<path d="M22 12h-4l-3 9L9 3l-3 9H2" />} />;
    const Moon = (p) => <IconBase {...p} d={<path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />} />;
    const Battery = (p) => <IconBase {...p} d={<><rect width="16" height="10" x="2" y="7" rx="2" ry="2" /><line x1="22" x2="22" y1="11" y2="13" /></>} />;
    const Calendar = (p) => <IconBase {...p} d={<><rect width="18" height="18" x="3" y="4" rx="2" ry="2" /><line x1="16" x2="16" y1="2" y2="6" /><line x1="8" x2="8" y1="2" y2="6" /><line x1="3" x2="21" y1="10" y2="10" /></>} />;
    const ChevronRight = (p) => <IconBase {...p} d={<path d="m9 18 6-6-6-6" />} />;
    const ChevronLeft = (p) => <IconBase {...p} d={<path d="m15 18-6-6 6-6" />} />;
    const Settings = (p) => <IconBase {...p} d={<><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" /><circle cx="12" cy="12" r="3" /></>} />;
    const RefreshCcw = (p) => <IconBase {...p} d={<><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" /><path d="M3 3v5h5" /><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16" /><path d="M16 16h5v5" /></>} />;
    const Trophy = (p) => <IconBase {...p} d={<><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" /><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" /><path d="M4 22h16" /><path d="M10 14.66V17" /><path d="M14 14.66V17" /><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" /><path d="M8.5 22l1-4h5l1 4" /></>} />;
    const AlertCircle = (p) => <IconBase {...p} d={<><circle cx="12" cy="12" r="10" /><line x1="12" x2="12" y1="8" y2="12" /><line x1="12" x2="12.01" y1="16" y2="16" /></>} />;
    const CheckCircle2 = (p) => <IconBase {...p} d={<><circle cx="12" cy="12" r="10" /><path d="m9 12 2 2 4-4" /></>} />;
    const Minus = (p) => <IconBase {...p} d={<path d="M5 12h14" />} />;
    const Plus = (p) => <IconBase {...p} d={<path d="M12 5v14M5 12h14" />} />;

    // --- Data ---
    const FIXED_PROFILE = {
      age: 42, rhrBase: 51, vo2max: 48,
      z2: { l: '130â€“135', m: '135â€“140', u: '140â€“145' }
    };

    const QUOTES = [
      "ç©©å®šç´¯ç©ï¼Œæ‰æ˜¯çœŸæ­£çš„å¤©è³¦ã€‚", "ä»Šå¤©çš„ä¿å®ˆï¼Œæ˜¯æ˜å¤©çš„çªç ´ã€‚", "æŠŠèº«é«”ç…§é¡§å¥½ï¼Œé€Ÿåº¦è‡ªç„¶æœƒä¾†ã€‚",
      "æœ‰æ°§åŸºç¤æ±ºå®šä½ çš„å¤§æ¨“èƒ½è“‹å¤šé«˜ã€‚", "æ…¢å°±æ˜¯é †ï¼Œé †å°±æ˜¯å¿«ã€‚", "å¿ƒç‡ä¸æœƒèªªè¬Šï¼Œå­¸æœƒå‚¾è½èº«é«”çš„è²éŸ³ã€‚",
      "ä¼‘æ¯ä¸æ˜¯å·æ‡¶ï¼Œæ˜¯è¨“ç·´çš„ä¸€éƒ¨åˆ†ã€‚", "Zone 2 æ˜¯é¦¬æ‹‰æ¾è·‘è€…çš„ä¿®ç…‰å ´ã€‚", "æ§åˆ¶å¼·åº¦ï¼Œæ‰èƒ½å»¶çºŒé•·åº¦ã€‚",
      "ä¸è¦ç‚ºäº†ä»Šå¤©çš„è™›æ¦®ï¼ŒçŠ§ç‰²æ˜å¤©çš„è¨“ç·´ã€‚", "çœŸæ­£çš„å¼·å¤§æ˜¯è‡ªå¾‹ï¼ŒåŒ…æ‹¬è‡ªå¾‹åœ°æ…¢ä¸‹ä¾†ã€‚", "æµæ°´ä¸çˆ­å…ˆï¼Œçˆ­çš„æ˜¯æ»”æ»”ä¸çµ•ã€‚",
      "æ¯ä¸€æ»´æ±—æ°´éƒ½åœ¨ç‚ºç ´ 100 åˆ†é˜é‹ªè·¯ã€‚", "è€åŠ›æ˜¯å­˜éŒ¢ï¼Œæ¯”è³½æ˜¯èŠ±éŒ¢ã€‚", "åˆ¥è®“ ego æ§åˆ¶ä½ çš„é…é€Ÿã€‚",
      "æ¯ç‡¥çš„é‡è¤‡ï¼Œæ˜¯å“è¶Šçš„é–‹å§‹ã€‚", "ä»Šå¤©çš„ Zone 2ï¼Œæ˜¯ç‚ºäº†å…©å¹´å¾Œçš„å¾®ç¬‘ã€‚", "æ²’æœ‰å¥‡è¹Ÿï¼Œåªæœ‰ç´¯ç©ã€‚",
      "å°Šé‡èª²è¡¨ï¼Œå°±æ˜¯å°Šé‡ç›®æ¨™ã€‚", "å¯§å¯ç·´å°‘ï¼Œä¸è¦ç·´çˆ†ã€‚", "è®“å¿ƒè‡Ÿè®Šå¼·å¤§ï¼Œè€Œä¸æ˜¯è®“è‚Œè‚‰è®Šç–²å‹ã€‚",
      "è¼•é¬†è·‘çš„æ„ç¾©åœ¨æ–¼ã€Œè¼•é¬†ã€ã€‚", "é•·è·‘æ˜¯èˆ‡è‡ªå·±çš„å°è©±ï¼Œä»Šå¤©è«‹æº«æŸ”ä¸€é»ã€‚", "ä¿æŒå¥åº·ï¼Œæ‰èƒ½è·‘åˆ°çµ‚é»ã€‚",
      "æ”¶èµ·ä½ çš„å¥½å‹å¿ƒï¼ŒæŠŠå®ƒç•™åœ¨æ¯”è³½æ—¥ã€‚"
    ];

    const SLEEP_OPTIONS = [4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0];
    const FATIGUE_OPTIONS = [
      { val: 0, label: "ç²¾åŠ›å……æ²›" }, { val: 1, label: "ç‹€æ…‹è‰¯å¥½" }, { val: 2, label: "æœ‰é»ç–²å‹" },
      { val: 3, label: "æ˜é¡¯ç–²å‹" }, { val: 4, label: "éå¸¸ç–²æ†Š" }, { val: 5, label: "æ¥µåº¦ç–²æ†Š" },
    ];

    // --- Components ---
    const Card = ({ children, className = "" }) => (
      <div className={`bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden ${className}`}>
        {children}
      </div>
    );

    const ProgressBar = ({ current, total }) => (
      <div className="w-full h-1.5 bg-slate-100 rounded-full mb-6">
        <div className="h-full bg-sky-500 rounded-full transition-all duration-300" style={{ width: `${(current / total) * 100}%` }} />
      </div>
    );

    const Stepper = ({ value, onChange, min, max, unit, step = 1, largeStep = 5 }) => {
      const handleChange = (newValue) => {
        if (newValue >= min && newValue <= max) onChange(newValue);
      };
      return (
        <div className="flex flex-col items-center gap-4 py-4">
          <div className="flex items-center gap-6">
            <button onClick={() => handleChange(value - step)} disabled={value <= min} className="w-16 h-16 rounded-full border-2 border-slate-200 bg-white flex items-center justify-center text-slate-600 shadow-sm active:scale-95 active:bg-slate-50 transition-all hover:border-sky-200 hover:text-sky-600 disabled:opacity-30 disabled:cursor-not-allowed">
              <Minus className="w-8 h-8" />
            </button>
            <div className="text-center min-w-[100px]">
              <div className="text-6xl font-bold text-slate-700 font-mono tracking-tighter">{value}</div>
              <div className="text-slate-400 font-medium text-sm mt-1">{unit}</div>
            </div>
            <button onClick={() => handleChange(value + step)} disabled={value >= max} className="w-16 h-16 rounded-full border-2 border-slate-200 bg-white flex items-center justify-center text-slate-600 shadow-sm active:scale-95 active:bg-slate-50 transition-all hover:border-sky-200 hover:text-sky-600 disabled:opacity-30 disabled:cursor-not-allowed">
              <Plus className="w-8 h-8" />
            </button>
          </div>
          {(max - min > 20) && (
            <div className="flex gap-12 text-slate-400 font-medium">
              <button onClick={() => handleChange(value - largeStep)} disabled={value - largeStep < min} className="px-4 py-2 rounded-full hover:bg-slate-100 active:text-slate-600 transition-colors disabled:opacity-20">-{largeStep}</button>
              <button onClick={() => handleChange(value + largeStep)} disabled={value + largeStep > max} className="px-4 py-2 rounded-full hover:bg-slate-100 active:text-slate-600 transition-colors disabled:opacity-20">+{largeStep}</button>
            </div>
          )}
        </div>
      );
    };

    const App = () => {
      const [view, setView] = useState('home');
      const [step, setStep] = useState(1);
      const [showSettings, setShowSettings] = useState(false);
      const [quote, setQuote] = useState(QUOTES[0]);
      const [hrvBase, setHrvBase] = useState(40);
      const [tempHrvBase, setTempHrvBase] = useState(40);
      const [inputs, setInputs] = useState({ rhr: 51, hrv: 40, sleep: 7.0, fatigue: 1, cts: 1 });

      useEffect(() => {
        const savedData = localStorage.getItem('james_coach_data');
        if (savedData) {
          const parsed = JSON.parse(savedData);
          setHrvBase(parsed.hrvBase || 40);
          setInputs(prev => ({ ...prev, ...parsed.lastInputs }));
        }
      }, []);

      useEffect(() => {
        localStorage.setItem('james_coach_data', JSON.stringify({ hrvBase, lastInputs: inputs }));
      }, [hrvBase, inputs]);

      useEffect(() => {
        if (view === 'result') {
          const idx = Math.floor(Math.random() * QUOTES.length);
          setQuote(QUOTES[idx]);
        }
      }, [view]);

      const calculateResult = () => {
        const deltaRHR = inputs.rhr - FIXED_PROFILE.rhrBase;
        const isD = (deltaRHR >= 7 || inputs.hrv <= (hrvBase - 10) || inputs.fatigue >= 4 || inputs.cts >= 6);
        if (isD) return { level: 'D', reasons: getReasons('D', deltaRHR, inputs) };
        const isC = ((deltaRHR >= 5 && deltaRHR <= 6) || (inputs.hrv <= hrvBase - 6) || inputs.sleep < 6.0 || inputs.fatigue === 3 || inputs.cts === 5);
        if (isC) return { level: 'C', reasons: getReasons('C', deltaRHR, inputs) };
        const isB = ((deltaRHR >= 3 && deltaRHR <= 4) || (inputs.hrv >= hrvBase - 5 && inputs.hrv <= hrvBase - 1) || (inputs.sleep >= 6.0 && inputs.sleep <= 6.9) || inputs.fatigue === 2 || inputs.cts === 4);
        if (isB) return { level: 'B', reasons: getReasons('B', deltaRHR, inputs) };
        return { level: 'A', reasons: [] };
      };

      const getReasons = (level, dRHR, inp) => {
        const list = [];
        if (dRHR > 2) list.push(`éœæ¯å¿ƒç‡å‡é«˜ ${dRHR} bpm (æ¨™æº– â‰¤+2)`);
        if (inp.hrv < hrvBase) list.push(`HRV ä½æ–¼åŸºæº– ${hrvBase - inp.hrv} ms`);
        if (inp.sleep < 7) list.push(`ç¡çœ  ${inp.sleep} å°æ™‚ (ç›®æ¨™ â‰¥7)`);
        if (inp.fatigue > 1) list.push(`ç–²æ†ŠæŒ‡æ•¸ ${inp.fatigue} (ç›®æ¨™ â‰¤1)`);
        if (inp.cts > 3) list.push(`é€£çºŒè¨“ç·´ç¬¬ ${inp.cts} å¤© (å»ºè­° â‰¤3)`);
        if (level === 'D') {
          if (inp.cts >= 6) list.push("é€£çºŒè¨“ç·´å¤©æ•¸éé•· (ç´…ç‡ˆ)");
          if (inp.fatigue >= 4) list.push("ä¸»è§€ç–²å‹åº¦éé«˜");
        }
        return list;
      };

      const result = calculateResult();
      const handleInputChange = (field, value) => setInputs(prev => ({ ...prev, [field]: value }));
      const nextStep = () => { if (step < 5) setStep(step + 1); else setView('result'); };
      const prevStep = () => { if (step > 1) setStep(step - 1); else setView('home'); };
      const restart = () => { setStep(1); setView('home'); };

      const HomeView = () => (
        <div className="space-y-6 pb-20 p-4">
          <header className="text-center pt-8 pb-4">
            <div className="inline-flex items-center justify-center p-3 bg-sky-100 rounded-full mb-4"><Activity className="w-8 h-8 text-sky-600" /></div>
            <h1 className="text-2xl font-bold text-slate-800">James å°ˆå±¬æ•™ç·´</h1>
            <p className="text-slate-500 text-sm mt-1">Zone 2 é«˜æ•ˆæœ‰æ°§è¨“ç·´ç³»çµ±</p>
          </header>
          <Card className="p-5 bg-gradient-to-br from-slate-50 to-white">
            <div className="flex justify-between items-start mb-4"><h3 className="font-bold text-slate-700 flex items-center gap-2"><Trophy className="w-4 h-4 text-amber-500" /> é•·æœŸç›®æ¨™</h3></div>
            <p className="text-sm text-slate-600 leading-relaxed">2 å¹´å…§æœ€å¤§åŒ–æœ‰æ°§åŸºç¤ï¼Œå‚™æˆ°ç¬¬ 3 å¹´åŠé¦¬ç ´ <span className="font-bold text-slate-800">100 åˆ†é˜</span>ã€‚</p>
          </Card>
          <div className="grid grid-cols-2 gap-4">
            <Card className="p-4 text-center"><div className="text-xs text-slate-400 mb-1">éœæ¯å¿ƒç‡ RHR</div><div className="text-2xl font-bold text-slate-700">{FIXED_PROFILE.rhrBase} <span className="text-xs font-normal">bpm</span></div></Card>
            <Card className="p-4 text-center"><div className="text-xs text-slate-400 mb-1">VO2max</div><div className="text-2xl font-bold text-slate-700">{FIXED_PROFILE.vo2max}</div></Card>
          </div>
          <Card className="p-0">
            <div className="bg-sky-50 p-3 border-b border-sky-100"><h3 className="text-sm font-bold text-sky-800 text-center">Zone 2 å¿ƒç‡å€æ®µ</h3></div>
            <div className="divide-y divide-slate-100">
              <div className="flex justify-between p-3 px-6"><span className="text-slate-500 text-sm">Z2-L (ä½)</span><span className="font-mono font-medium text-slate-700">{FIXED_PROFILE.z2.l}</span></div>
              <div className="flex justify-between p-3 px-6 bg-slate-50/50"><span className="text-slate-500 text-sm">Z2-M (ä¸­)</span><span className="font-mono font-medium text-slate-700">{FIXED_PROFILE.z2.m}</span></div>
              <div className="flex justify-between p-3 px-6"><span className="text-slate-500 text-sm">Z2-U (é«˜)</span><span className="font-mono font-medium text-slate-700">{FIXED_PROFILE.z2.u}</span></div>
            </div>
          </Card>
          <div className="fixed bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-md border-t border-slate-200 z-50">
            <button onClick={() => setView('wizard')} className="w-full bg-sky-600 hover:bg-sky-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-sky-200 transition-all active:scale-[0.98] flex items-center justify-center gap-2">é–‹å§‹ä»Šæ—¥è¨“ç·´åˆ¤æ–· <ChevronRight className="w-5 h-5" /></button>
          </div>
        </div>
      );

      const WizardView = () => (
        <div className="flex flex-col h-screen p-4">
          <div className="flex items-center justify-between mb-6 pt-2">
            <button onClick={prevStep} className="p-2 -ml-2 text-slate-400 hover:text-slate-600"><ChevronLeft /></button>
            <span className="text-sm font-medium text-slate-400">Step {step} / 5</span>
            <div className="w-8" />
          </div>
          <ProgressBar current={step} total={5} />
          <div className="flex-1 overflow-y-auto pb-32">
            {step === 1 && (
              <div className="space-y-8 animate-[fadeIn_0.3s_ease-out]">
                <div className="text-center"><Heart className="w-12 h-12 text-rose-500 mx-auto mb-4" /><h2 className="text-2xl font-bold text-slate-800 mb-2">ä»Šæ—¥éœæ¯å¿ƒç‡</h2><p className="text-slate-500">å‰›èµ·åºŠæ™‚æ¸¬é‡çš„ RHR</p></div>
                <div className="px-4">
                  <Stepper value={inputs.rhr} onChange={(val) => handleInputChange('rhr', val)} min={40} max={80} unit="bpm" />
                  <div className="text-center mt-4 text-sm text-slate-500">åŸºæº–å€¼: {FIXED_PROFILE.rhrBase} bpm</div>
                </div>
              </div>
            )}
            {step === 2 && (
              <div className="space-y-8 animate-[fadeIn_0.3s_ease-out]">
                <div className="text-center"><Activity className="w-12 h-12 text-emerald-500 mx-auto mb-4" /><h2 className="text-2xl font-bold text-slate-800 mb-2">è¿‘ 7 æ—¥ HRV</h2><p className="text-slate-500">åæ˜ èº«é«”è‡ªä¸»ç¥ç¶“æ¢å¾©ç‹€æ³</p></div>
                <div className="px-4">
                  <Stepper value={inputs.hrv} onChange={(val) => handleInputChange('hrv', val)} min={10} max={150} unit="ms" largeStep={5} />
                  <button onClick={() => { if (!showSettings) setTempHrvBase(hrvBase); setShowSettings(!showSettings); }} className="mt-8 mx-auto flex items-center gap-2 text-sm text-slate-400 hover:text-slate-600 bg-slate-50 px-4 py-2 rounded-full border border-slate-200"><Settings className="w-4 h-4" />{showSettings ? 'éš±è—è¨­å®š' : 'è¨­å®š HRV åŸºæº–'}</button>
                  {showSettings && (
                    <div className="mt-4 p-4 bg-slate-50 rounded-xl border border-slate-200">
                      <label className="block text-sm font-medium text-slate-600 mb-2">HRV åŸºæº–å€¼ (è¿‘3å€‹æœˆå¹³å‡)</label>
                      <div className="flex items-center gap-2">
                        <input type="number" value={tempHrvBase} onChange={(e) => setTempHrvBase(e.target.value)} className="flex-1 p-2 border border-slate-300 rounded-lg text-center font-mono font-bold text-lg" placeholder={hrvBase} />
                        <button onClick={() => { const val = parseInt(tempHrvBase); if (!isNaN(val) && val > 0) { setHrvBase(val); setShowSettings(false); } }} className="bg-slate-800 text-white px-4 py-2 rounded-lg font-bold shadow-sm active:scale-95 transition-transform whitespace-nowrap">ç¢ºèª</button>
                      </div>
                      <div className="text-center mt-2 text-xs text-slate-400">ç›®å‰è¨­å®š: {hrvBase} ms</div>
                    </div>
                  )}
                </div>
              </div>
            )}
            {step === 3 && (
              <div className="space-y-8 animate-[fadeIn_0.3s_ease-out]">
                <div className="text-center"><Moon className="w-12 h-12 text-indigo-500 mx-auto mb-4" /><h2 className="text-2xl font-bold text-slate-800 mb-2">æ˜¨æ™šç¡çœ æ™‚é•·</h2><p className="text-slate-500">åŒ…å«åˆç¡çš„ç¸½æ™‚æ•¸</p></div>
                <div className="grid grid-cols-2 gap-3 px-2">
                  {SLEEP_OPTIONS.map((val) => (
                    <button key={val} onClick={() => handleInputChange('sleep', val)} className={`p-4 rounded-xl text-lg font-bold transition-all ${inputs.sleep === val ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-200 scale-105' : 'bg-white border border-slate-200 text-slate-600 hover:bg-slate-50'}`}>{val} <span className="text-sm font-normal opacity-80" { /* typo fix if any */ }>hr</span></button>
                  ))}
                </div>
              </div>
            )}
            {step === 4 && (
              <div className="space-y-8 animate-[fadeIn_0.3s_ease-out]">
                <div className="text-center"><Battery className="w-12 h-12 text-amber-500 mx-auto mb-4" /><h2 className="text-2xl font-bold text-slate-800 mb-2">ä¸»è§€ç–²æ†Šåº¦</h2><p className="text-slate-500">èª å¯¦é¢å°èº«é«”çš„æ„Ÿè¦º</p></div>
                <div className="space-y-3 px-2">
                  {FATIGUE_OPTIONS.map((opt) => (
                    <button key={opt.val} onClick={() => handleInputChange('fatigue', opt.val)} className={`w-full p-4 rounded-xl text-left flex justify-between items-center transition-all ${inputs.fatigue === opt.val ? 'bg-amber-500 text-white shadow-lg shadow-amber-200 scale-[1.02] border-amber-500' : 'bg-white border border-slate-200 text-slate-600 hover:bg-slate-50'}`}><span className="font-bold text-lg">{opt.val}</span><span className="font-medium">{opt.label}</span></button>
                  ))}
                </div>
              </div>
            )}
            {step === 5 && (
              <div className="space-y-8 animate-[fadeIn_0.3s_ease-out]">
                <div className="text-center"><Calendar className="w-12 h-12 text-sky-500 mx-auto mb-4" /><h2 className="text-2xl font-bold text-slate-800 mb-2">é€£çºŒè¨“ç·´æ—¥æ•¸ (CTS)</h2><p className="text-slate-500">å«ä»Šæ—¥ä¹‹å‰çš„é€£çºŒé‹å‹•å¤©æ•¸</p></div>
                <div className="px-4">
                  <div className="grid grid-cols-4 gap-3 mb-6">
                    {[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map(val => (
                      <button key={val} onClick={() => handleInputChange('cts', val)} className={`p-3 rounded-lg text-lg font-bold transition-all ${inputs.cts === val ? 'bg-sky-600 text-white shadow-lg shadow-sky-200' : 'bg-white border border-slate-200 text-slate-600'} ${val >= 6 ? 'border-rose-100 bg-rose-50 text-rose-600' : ''}`}>{val}</button>
                    ))}
                  </div>
                  {inputs.cts >= 6 && (<div className="flex items-center gap-2 p-3 bg-rose-50 text-rose-700 rounded-lg text-sm border border-rose-100 animate-pulse"><AlertCircle className="w-5 h-5" />é€£çºŒ â‰¥6 å¤©å±¬é«˜é¢¨éšªç´¯ç©ï¼Œå»ºè­°ä¼‘æ¯</div>)}
                </div>
              </div>
            )}
          </div>
          <div className="fixed bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-md border-t border-slate-200 z-50">
            <button onClick={nextStep} className="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-[0.98] flex items-center justify-center gap-2">{step === 5 ? 'ç”¢ç”Ÿä»Šæ—¥èª²è¡¨' : 'ä¸‹ä¸€æ­¥'} <ChevronRight className="w-5 h-5" /></button>
          </div>
        </div>
      );

      const ResultView = () => {
        const levelConfig = {
          A: { color: 'bg-emerald-500', text: 'text-emerald-700', bg: 'bg-emerald-50', border: 'border-emerald-100', title: 'ç‹€æ…‹çµ•ä½³' },
          B: { color: 'bg-sky-500', text: 'text-sky-700', bg: 'bg-sky-50', border: 'border-sky-100', title: 'ç‹€æ…‹ç©©å®š' },
          C: { color: 'bg-orange-500', text: 'text-orange-700', bg: 'bg-orange-50', border: 'border-orange-100', title: 'éœ€è¦æ³¨æ„' },
          D: { color: 'bg-rose-500', text: 'text-rose-700', bg: 'bg-rose-50', border: 'border-rose-100', title: 'å¼·åˆ¶æ¢å¾©' },
        };
        const workoutConfig = {
          A: { hr: '140â€“145 bpm', time: '75â€“95 åˆ†é˜', note: 'ç©©å®šä¸Šç·£ã€å¾ŒåŠ HR æ¼‚ç§» <5%' },
          B: { hr: '135â€“140 bpm', time: '50â€“75 åˆ†é˜', note: 'å…¨ç¨‹å¯å°è©±ã€ä¸æ’ä¸Šç·£' },
          C: { hr: '130â€“135 bpm', time: '30â€“50 åˆ†é˜', note: 'åªä¿ç•™æœ‰æ°§è¨Šè™Ÿï¼Œä¸è¿½æ±‚é…é€Ÿ' },
          D: { hr: '< 130 bpm', time: '0 æˆ– 20â€“30 åˆ†é˜', note: 'ä»Šå¤©è·‘åªæœƒæ¶ˆè€—ï¼Œå»ºè­°å…¨ä¼‘æˆ–æ•£æ­¥' },
        };
        const config = levelConfig[result.level];
        const workout = workoutConfig[result.level];
        const [showRecovery, setShowRecovery] = useState(false);
        const getSummary = () => {
          if (result.level === 'A') return "å„é …æŒ‡æ¨™å®Œç¾ï¼Œä»Šå¤©æ˜¯å¯ä»¥ç´¯ç©è·‘é‡çš„æ—¥å­ï¼";
          if (result.level === 'D') return "èº«é«”ç™¼å‡ºæ±‚æ•‘è¨Šè™Ÿï¼Œè«‹å‹™å¿…å°Šé‡æ¢å¾©éœ€æ±‚ã€‚";
          const reasonsShort = result.reasons.length > 0 ? result.reasons[0].split(' ')[0] : 'ç‹€æ…‹';
          return `ä»Šæ—¥${reasonsShort}ç¨æœ‰åå·®ï¼Œé©åˆæ¡å–${result.level === 'B' ? 'ä¿å®ˆ' : 'æ¸›é‡'}ç­–ç•¥ã€‚`;
        };

        return (
          <div className="pb-24 animate-[fadeIn_0.5s_ease-out]">
            <div className={`${config.color} text-white p-8 rounded-b-3xl shadow-lg relative overflow-hidden mb-6`}>
              <div className="absolute top-0 right-0 opacity-10 transform translate-x-10 -translate-y-10"><Activity className="w-48 h-48" /></div>
              <div className="relative z-10 text-center">
                <div className="text-sm font-medium opacity-90 mb-1">ä»Šæ—¥è¨“ç·´ç­‰ç´š</div>
                <div className="text-6xl font-black mb-2 flex items-center justify-center gap-3">{result.level}<span className="text-2xl font-bold opacity-80 border border-white/30 rounded-full px-3 py-1">{config.title}</span></div>
                <p className="text-white/90 font-medium">{getSummary()}</p>
              </div>
            </div>
            <div className="px-4 space-y-6">
              <Card className="p-0 border-0 shadow-md">
                <div className="bg-slate-800 text-white p-4 flex items-center gap-2"><CheckCircle2 className="w-5 h-5 text-sky-400" /><h3 className="font-bold">ä»Šæ—¥èª²è¡¨åŸ·è¡Œé‡é»</h3></div>
                <div className="p-5 grid gap-6">
                  <div className="flex items-center justify-between border-b border-slate-100 pb-4"><span className="text-slate-500 font-medium">ç›®æ¨™å¿ƒç‡</span><span className="text-2xl font-bold text-slate-800 font-mono">{workout.hr}</span></div>
                  <div className="flex items-center justify-between border-b border-slate-100 pb-4"><span className="text-slate-500 font-medium">è¨“ç·´æ™‚é•·</span><span className="text-2xl font-bold text-slate-800 font-mono">{workout.time}</span></div>
                  <div><span className="text-slate-500 font-medium block mb-2">æ•™ç·´å®åš€</span><div className={`${config.bg} ${config.text} p-3 rounded-lg font-medium border ${config.border}`}>{workout.note}</div></div>
                </div>
              </Card>
              {result.level !== 'A' && (
                <div className="space-y-2">
                  <h4 className="text-sm font-bold text-slate-400 uppercase tracking-wider ml-1">ç‚ºä½•ä¸æ˜¯ Level Aï¼Ÿ</h4>
                  <Card className="p-4 bg-slate-50 border-slate-200"><ul className="space-y-2">{result.reasons.map((r, idx) => (<li key={idx} className="flex items-start gap-2 text-slate-600 text-sm"><span className="text-rose-500 font-bold">â€¢</span> {r}</li>))}</ul></Card>
                </div>
              )}
              {result.level === 'D' && (
                <div className="border border-rose-200 rounded-xl overflow-hidden bg-white">
                  <button onClick={() => setShowRecovery(!showRecovery)} className="w-full flex items-center justify-between p-4 bg-rose-50 text-rose-700 font-bold"><span>ğŸš‘ æ˜æ—¥å›åˆ° A/B çš„æ¢å¾©æ¸…å–®</span><ChevronRight className={`transform transition-transform ${showRecovery ? 'rotate-90' : ''}`} /></button>
                  {showRecovery && (<div className="p-4 bg-white text-sm text-slate-600 space-y-3"><div className="flex gap-2"><input type="checkbox" className="mt-1" /> <span>ç«‹åˆ»è£œå…… 500ml æ°´åˆ†èˆ‡é›»è§£è³ª</span></div><div className="flex gap-2"><input type="checkbox" className="mt-1" /> <span>ä»Šæ™šææ—© 1 å°æ™‚å°±å¯¢ï¼ˆç›®æ¨™ 8hr+ï¼‰</span></div><div className="flex gap-2"><input type="checkbox" className="mt-1" /> <span>ä½¿ç”¨æ»¾ç­’æ”¾é¬†å¤§è…¿èˆ‡å°è…¿</span></div><div className="flex gap-2"><input type="checkbox" className="mt-1" /> <span>å®Œå…¨æ”¾ä¸‹ã€Œä»Šå¤©æ²’è·‘æœƒé€€æ­¥ã€çš„å¿µé ­</span></div></div>)}
                </div>
              )}
              <div className="py-6 text-center"><div className="text-sky-500 text-4xl font-serif leading-none mb-2">â€œ</div><p className="text-slate-600 font-medium text-lg px-6 italic font-serif">{quote}</p><div className="mt-2 w-12 h-1 bg-sky-200 mx-auto rounded-full"></div></div>
            </div>
            <div className="fixed bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-md border-t border-slate-200 flex gap-3 z-50">
              <button onClick={restart} className="flex-1 bg-white border border-slate-300 text-slate-600 font-bold py-3 rounded-xl shadow-sm hover:bg-slate-50 flex items-center justify-center gap-2"><RefreshCcw className="w-4 h-4" /> é‡æ–°è©•ä¼°</button>
            </div>
          </div>
        );
      };

      return (
        <div className="min-h-screen bg-slate-50 font-sans text-slate-900 max-w-md mx-auto shadow-2xl overflow-hidden relative">
          {view === 'home' && <HomeView />}
          {view === 'wizard' && <WizardView />}
          {view === 'result' && <ResultView />}
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>

</html>